import{s as W,y as g,i as _,n as u,f as h,k as w,e as y,c as k,l as v,m as p,q as E}from"./scheduler.CXEVs2ap.js";import{S as x,i as L}from"./index.CTdcniaS.js";import{_ as C}from"./preload-helper.Dch09mLN.js";import{w as R}from"./index.Lgv2TFSy.js";function N(l={}){const{immediate:e=!1,onNeedRefresh:s,onOfflineReady:n,onRegistered:t,onRegisteredSW:i,onRegisterError:r}=l;let o,c,f;const b=async(a=!0)=>{await c,await f?.()};async function S(){if("serviceWorker"in navigator){if(o=await C(async()=>{const{Workbox:a}=await import("./workbox-window.prod.es5.D5gOYdM7.js");return{Workbox:a}},[],import.meta.url).then(({Workbox:a})=>new a("/sw.js",{scope:"/",type:"classic"})).catch(a=>{r?.(a)}),!o)return;f=async()=>{await o?.messageSkipWaiting()};{let a=!1;const m=()=>{a=!0,o?.addEventListener("controlling",d=>{d.isUpdate&&window.location.reload()}),s?.()};o.addEventListener("installed",d=>{typeof d.isUpdate>"u"?typeof d.isExternal<"u"?d.isExternal?m():!a&&n?.():d.isExternal?window.location.reload():!a&&n?.():d.isUpdate||n?.()}),o.addEventListener("waiting",m),o.addEventListener("externalwaiting",m)}o.register({immediate:e}).then(a=>{i?i("/sw.js",a):t?.(a)}).catch(a=>{r?.(a)})}}return c=S(),b}function P(l={}){const{immediate:e=!0,onNeedRefresh:s,onOfflineReady:n,onRegistered:t,onRegisteredSW:i,onRegisterError:r}=l,o=R(!1),c=R(!1),f=N({immediate:e,onOfflineReady(){c.set(!0),n?.()},onNeedRefresh(){o.set(!0),s?.()},onRegistered:t,onRegisteredSW:i,onRegisterError:r});return{needRefresh:o,offlineReady:c,updateServiceWorker:f}}function U(l){let e,s="offline_pin";return{c(){e=y("div"),e.textContent=s,this.h()},l(n){e=k(n,"DIV",{title:!0,class:!0,"data-svelte-h":!0}),v(e)!=="svelte-u4b4iq"&&(e.textContent=s),this.h()},h(){p(e,"title","App can now be used offline"),p(e,"class","icon")},m(n,t){_(n,e,t)},p:u,d(n){n&&h(e)}}}function O(l){let e,s='Update <span class="icon">update</span>',n,t;return{c(){e=y("button"),e.innerHTML=s,this.h()},l(i){e=k(i,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),v(e)!=="svelte-trksef"&&(e.innerHTML=s),this.h()},h(){p(e,"title","Update ready"),p(e,"class","svelte-9dwesr")},m(i,r){_(i,e,r),n||(t=E(e,"click",l[5]),n=!0)},p:u,d(i){i&&h(e),n=!1,t()}}}function T(l){let e;function s(i,r){if(i[0])return O;if(i[1])return U}let n=s(l),t=n&&n(l);return{c(){t&&t.c(),e=g()},l(i){t&&t.l(i),e=g()},m(i,r){t&&t.m(i,r),_(i,e,r)},p(i,[r]){n===(n=s(i))&&t?t.p(i,r):(t&&t.d(1),t=n&&n(i),t&&(t.c(),t.m(e.parentNode,e)))},i:u,o:u,d(i){i&&h(e),t&&t.d(i)}}}function q(l,e,s){let n,t;const{needRefresh:i,updateServiceWorker:r,offlineReady:o}=P();return w(l,i,f=>s(0,n=f)),w(l,o,f=>s(1,t=f)),[n,t,i,r,o,()=>r(!0)]}class H extends x{constructor(e){super(),L(this,e,q,T,W,{})}}export{H as default};
//# sourceMappingURL=PwaStatus.DCC9dwtH.js.map
