{"version":3,"file":"6.DzO8xybo.js","sources":["../../../../../../src/routes/(app)/config/chords/action-selector.ts","../../../../../../src/routes/(app)/config/chords/input-converter.ts","../../../../../../src/routes/(app)/config/chords/ChordPhraseEdit.svelte","../../../../../../src/routes/(app)/config/chords/ChordActionEdit.svelte","../../../../../../src/routes/(app)/config/chords/ChordEdit.svelte","../../../../../../src/routes/(app)/config/chords/+page.svelte"],"sourcesContent":["import ActionSelector from \"$lib/components/layout/ActionSelector.svelte\";\nimport { tick } from \"svelte\";\n\nexport function selectAction(\n  event: MouseEvent | KeyboardEvent,\n  select: (action: number) => void,\n  dismissed?: () => void,\n) {\n  const component = new ActionSelector({ target: document.body });\n  const dialog = document.querySelector(\"dialog > div\") as HTMLDivElement;\n  const backdrop = document.querySelector(\"dialog\") as HTMLDialogElement;\n  const dialogRect = dialog.getBoundingClientRect();\n  const groupRect = (event.target as HTMLElement).getBoundingClientRect();\n\n  const scale = 0.5;\n  const dialogScale = `${\n    1 - scale * (1 - groupRect.width / dialogRect.width)\n  } ${1 - scale * (1 - groupRect.height / dialogRect.height)}`;\n  const dialogTranslate = `${scale * (groupRect.x - dialogRect.x)}px ${\n    scale * (groupRect.y - dialogRect.y)\n  }px`;\n\n  const duration = 150;\n  const options = { duration, easing: \"ease\" };\n  const dialogAnimation = dialog.animate(\n    [\n      { scale: dialogScale, translate: dialogTranslate },\n      { translate: \"0 0\", scale: \"1\" },\n    ],\n    options,\n  );\n  const backdropAnimation = backdrop.animate(\n    [{ opacity: 0 }, { opacity: 1 }],\n    options,\n  );\n\n  async function closed() {\n    dialogAnimation.reverse();\n    backdropAnimation.reverse();\n\n    await dialogAnimation.finished;\n\n    component.$destroy();\n    await tick();\n    dismissed?.();\n  }\n\n  component.$on(\"close\", closed);\n  component.$on(\"select\", ({ detail }) => {\n    select(detail);\n    closed();\n  });\n}\n","import { KEYMAP_IDS, KEYMAP_KEYCODES } from \"$lib/serial/keymap-codes\";\n\nexport function inputToAction(\n  event: KeyboardEvent,\n  useKeycodes?: boolean,\n): number | undefined {\n  if (useKeycodes) {\n    return KEYMAP_KEYCODES.get(event.code);\n  } else {\n    return KEYMAP_IDS.get(event.key)?.code ?? KEYMAP_KEYCODES.get(event.code);\n  }\n}\n","<script lang=\"ts\">\n  import { onMount, tick } from \"svelte\";\n  import { changes, ChangeType } from \"$lib/undo-redo\";\n  import type { ChordInfo } from \"$lib/undo-redo\";\n  import { scale } from \"svelte/transition\";\n  import ActionString from \"$lib/components/ActionString.svelte\";\n  import { selectAction } from \"./action-selector\";\n  import { inputToAction } from \"./input-converter\";\n  import { serialPort } from \"$lib/serial/connection\";\n  import { get } from \"svelte/store\";\n\n  export let chord: ChordInfo;\n\n  onMount(() => {\n    if (chord.phrase.length === 0) {\n      box.focus();\n    }\n  });\n\n  function keypress(event: KeyboardEvent) {\n    if (event.key === \"ArrowUp\") {\n      addSpecial(event);\n    } else if (event.key === \"ArrowLeft\") {\n      moveCursor(cursorPosition - 1);\n    } else if (event.key === \"ArrowRight\") {\n      moveCursor(cursorPosition + 1);\n    } else if (event.key === \"Backspace\") {\n      deleteAction(cursorPosition - 1);\n      moveCursor(cursorPosition - 1);\n    } else if (event.key === \"Delete\") {\n      deleteAction(cursorPosition);\n    } else {\n      if (event.key === \"Shift\") return;\n      const action = inputToAction(event, get(serialPort)?.device === \"X\");\n      if (action !== undefined) {\n        insertAction(cursorPosition, action);\n        tick().then(() => moveCursor(cursorPosition + 1));\n      }\n    }\n  }\n\n  function moveCursor(to: number) {\n    cursorPosition = Math.max(0, Math.min(to, chord.phrase.length));\n    const item = box.children.item(cursorPosition) as HTMLElement;\n    cursorOffset = item.offsetLeft + item.offsetWidth;\n  }\n\n  function deleteAction(at: number, count = 1) {\n    if (!(at in chord.phrase)) return;\n    changes.update((changes) => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord.id,\n        actions: chord.actions,\n        phrase: chord.phrase.toSpliced(at, count),\n      });\n      return changes;\n    });\n  }\n\n  function insertAction(at: number, action: number) {\n    changes.update((changes) => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord.id,\n        actions: chord.actions,\n        phrase: chord.phrase.toSpliced(at, 0, action),\n      });\n      return changes;\n    });\n  }\n\n  function clickCursor(event: MouseEvent) {\n    if (event.target === button) return;\n    const distance = (event as unknown as { layerX: number }).layerX;\n\n    let i = 0;\n    for (const child of box.children) {\n      const { offsetLeft, offsetWidth } = child as HTMLElement;\n      if (distance < offsetLeft + offsetWidth / 2) {\n        moveCursor(i - 1);\n        return;\n      }\n      i++;\n    }\n    moveCursor(i - 1);\n  }\n\n  function addSpecial(event: MouseEvent | KeyboardEvent) {\n    selectAction(\n      event,\n      (action) => {\n        insertAction(cursorPosition, action);\n        tick().then(() => moveCursor(cursorPosition + 1));\n      },\n      () => box.focus(),\n    );\n  }\n\n  let button: HTMLButtonElement;\n  let box: HTMLDivElement;\n  let cursorPosition = 0;\n  let cursorOffset = 0;\n\n  let hasFocus = false;\n</script>\n\n<!-- svelte-ignore a11y-autofocus -->\n<div\n  on:keydown={keypress}\n  on:mousedown={clickCursor}\n  role=\"textbox\"\n  tabindex=\"0\"\n  bind:this={box}\n  class:edited={!chord.deleted && chord.phraseChanged}\n  on:focusin={() => (hasFocus = true)}\n  on:focusout={(event) => {\n    if (event.relatedTarget !== button) hasFocus = false;\n  }}\n>\n  {#if hasFocus}\n    <div transition:scale class=\"cursor\" style:translate=\"{cursorOffset}px 0\">\n      <button class=\"icon\" bind:this={button} on:click={addSpecial}>add</button>\n    </div>\n  {:else}\n    <div />\n    <!-- placeholder for cursor placement -->\n  {/if}\n  <ActionString actions={chord.phrase} />\n  <sup>â€¢</sup>\n</div>\n\n<style lang=\"scss\">\n  sup {\n    translate: 0 -40%;\n    opacity: 0;\n    transition: opacity 250ms ease;\n  }\n\n  .cursor {\n    position: absolute;\n    transform: translateX(-50%);\n    translate: 0 0;\n\n    width: 2px;\n    height: 100%;\n\n    background: var(--md-sys-color-on-secondary-container);\n\n    transition: translate 50ms ease;\n\n    button {\n      position: absolute;\n      top: -24px;\n      left: 0;\n\n      height: 24px;\n      padding: 0;\n\n      color: var(--md-sys-color-on-secondary-container);\n\n      background: var(--md-sys-color-secondary-container);\n      border: 2px solid currentcolor;\n      border-radius: 12px 12px 12px 0;\n    }\n  }\n\n  .edited {\n    color: var(--md-sys-color-primary);\n\n    sup {\n      opacity: 1;\n    }\n  }\n\n  [role=\"textbox\"] {\n    cursor: text;\n\n    position: relative;\n\n    display: flex;\n    align-items: center;\n\n    height: 1em;\n    padding-block: 4px;\n\n    &::after,\n    &::before {\n      content: \"\";\n\n      position: absolute;\n      bottom: -4px;\n\n      width: 100%;\n      height: 1px;\n\n      opacity: 0;\n      background: currentcolor;\n\n      transition:\n        opacity 150ms ease,\n        scale 250ms ease;\n    }\n\n    &::after {\n      scale: 0 1;\n      transition-duration: 250ms;\n    }\n\n    &:hover::before {\n      opacity: 0.3;\n    }\n\n    &:focus-within {\n      outline: none;\n\n      &::after {\n        scale: 1;\n        opacity: 1;\n      }\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import type { ChordInfo } from \"$lib/undo-redo\";\n  import { changes, ChangeType } from \"$lib/undo-redo\";\n  import { createEventDispatcher } from \"svelte\";\n  import LL from \"$i18n/i18n-svelte\";\n  import ActionString from \"$lib/components/ActionString.svelte\";\n  import { selectAction } from \"./action-selector\";\n  import { serialPort } from \"$lib/serial/connection\";\n  import { get } from \"svelte/store\";\n  import { inputToAction } from \"./input-converter\";\n\n  export let chord: ChordInfo | undefined = undefined;\n\n  const dispatch = createEventDispatcher();\n\n  let pressedKeys = new Set<number>();\n  let editing = false;\n\n  function compare(a: number, b: number) {\n    return a - b;\n  }\n\n  function makeChordInput(...actions: number[]) {\n    const compound = compoundIndices ?? [];\n    return [\n      ...compound,\n      ...Array.from(\n        {\n          length: 12 - (compound.length + actions.length + 1),\n        },\n        () => 0,\n      ),\n      ...actions.toSorted(compare),\n    ];\n  }\n\n  function edit() {\n    pressedKeys = new Set();\n    editing = true;\n  }\n\n  function keydown(event: KeyboardEvent) {\n    // This is obviously a tradeoff\n    if (event.key === \"Tab\" || event.key === \"Escape\") return;\n    if (!editing) return;\n    event.preventDefault();\n    const input = inputToAction(event, get(serialPort)?.device === \"X\");\n    if (input == undefined) {\n      alert(\"Invalid key\");\n      return;\n    }\n    pressedKeys.add(input);\n    pressedKeys = pressedKeys;\n  }\n\n  function keyup() {\n    if (!editing) return;\n    editing = false;\n    if (pressedKeys.size < 1) return;\n    if (!chord) return dispatch(\"submit\", makeChordInput(...pressedKeys));\n    changes.update((changes) => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord!.id,\n        actions: makeChordInput(...pressedKeys),\n        phrase: chord!.phrase,\n      });\n      return changes;\n    });\n    return undefined;\n  }\n\n  function addSpecial(event: MouseEvent) {\n    selectAction(event, (action) => {\n      changes.update((changes) => {\n        console.log(compoundIndices, chordActions, action);\n        changes.push({\n          type: ChangeType.Chord,\n          id: chord!.id,\n          actions: makeChordInput(...chordActions!, action),\n          phrase: chord!.phrase,\n        });\n        return changes;\n      });\n    });\n  }\n\n  $: chordActions = chord?.actions\n    .slice(chord.actions.lastIndexOf(0) + 1)\n    .toSorted(compare);\n  $: compoundIndices = chord?.actions.slice(0, chord.actions.indexOf(0));\n</script>\n\n<button\n  class:deleted={chord && chord.deleted}\n  class:edited={chord && chord.actionsChanged}\n  class:invalid={chord &&\n    chordActions &&\n    (chordActions.length < 2 ||\n      chordActions.some((it, i) => chordActions[i] !== it))}\n  class=\"chord\"\n  on:click={edit}\n  on:keydown={keydown}\n  on:keyup={keyup}\n  on:blur={keyup}\n>\n  {#if editing && pressedKeys.size === 0}\n    <span>{$LL.configure.chords.HOLD_KEYS()}</span>\n  {:else if !editing && !chord}\n    <span>{$LL.configure.chords.NEW_CHORD()}</span>\n  {/if}\n  {#if !editing}\n    {#each compoundIndices ?? [] as index}\n      <sub>{index}</sub>\n    {/each}\n    {#if compoundIndices?.length}\n      <span>&rarr;</span>\n    {/if}\n  {/if}\n  <ActionString\n    display=\"keys\"\n    actions={editing ? [...pressedKeys].sort(compare) : chordActions ?? []}\n  />\n  <sup>â€¢</sup>\n  <button class=\"icon add\" on:click|stopPropagation={addSpecial}\n    >add_circle</button\n  >\n</button>\n\n<style lang=\"scss\">\n  span {\n    opacity: 0.5;\n\n    @media (prefers-contrast: more) {\n      opacity: 0.8;\n    }\n  }\n\n  sup {\n    translate: 0 -60%;\n    opacity: 0;\n    transition: opacity 250ms ease;\n  }\n\n  .add {\n    font-size: 18px;\n    height: 20px;\n    opacity: 0;\n    --icon-fill: 1;\n  }\n\n  .chord:hover .add {\n    opacity: 1;\n  }\n\n  .chord {\n    position: relative;\n\n    display: inline-flex;\n    gap: 4px;\n\n    height: 32px;\n    margin-inline: 4px;\n\n    &:focus-within {\n      outline: none;\n    }\n  }\n\n  .chord::after {\n    content: \"\";\n\n    position: absolute;\n    top: 50%;\n    transform-origin: center left;\n    translate: -20px 0;\n    scale: 0 1;\n\n    width: calc(100% - 60px);\n    height: 1px;\n\n    background: currentcolor;\n\n    transition:\n      scale 250ms ease,\n      color 250ms ease;\n  }\n\n  .edited {\n    color: var(--md-sys-color-primary);\n\n    & > sup {\n      opacity: 1;\n    }\n  }\n\n  .invalid {\n    color: var(--md-sys-color-error);\n  }\n\n  .deleted {\n    color: var(--md-sys-color-error);\n\n    &::after {\n      scale: 1;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { changes, ChangeType, chords } from \"$lib/undo-redo.js\";\n  import type { ChordInfo } from \"$lib/undo-redo.js\";\n  import ChordPhraseEdit from \"./ChordPhraseEdit.svelte\";\n  import ChordActionEdit from \"./ChordActionEdit.svelte\";\n  import type { Chord } from \"$lib/serial/chord\";\n  import { slide } from \"svelte/transition\";\n  import { charaFileToUriComponent } from \"$lib/share/share-url\";\n  import SharePopup from \"../SharePopup.svelte\";\n  import tippy from \"tippy.js\";\n  import { createEventDispatcher } from \"svelte\";\n\n  export let chord: ChordInfo;\n\n  const dispatch = createEventDispatcher<{ duplicate: void }>();\n\n  function remove() {\n    changes.update((changes) => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: chord.id,\n        actions: chord.actions,\n        phrase: chord.phrase,\n        deleted: true,\n      });\n      return changes;\n    });\n  }\n\n  function isSameChord(a: Chord, b: Chord) {\n    return (\n      a.actions.length === b.actions.length &&\n      a.actions.every((it, i) => it === b.actions[i])\n    );\n  }\n\n  function restore() {\n    changes.update((changes) =>\n      changes.filter(\n        (it) => !(it.type === ChangeType.Chord && isSameChord(it, chord)),\n      ),\n    );\n  }\n\n  function duplicate() {\n    const id = [...chord.id];\n    id.splice(id.indexOf(0), 1);\n    id.push(0);\n    while ($chords.some((it) => JSON.stringify(it.id) === JSON.stringify(id))) {\n      id[id.length - 1]++;\n    }\n\n    changes.update((changes) => {\n      changes.push({\n        type: ChangeType.Chord,\n        id,\n        actions: [...chord.actions],\n        phrase: [...chord.phrase],\n      });\n      return changes;\n    });\n\n    dispatch(\"duplicate\");\n  }\n\n  async function share(event: Event) {\n    const url = new URL(window.location.href);\n    url.searchParams.set(\n      \"import\",\n      await charaFileToUriComponent({\n        charaVersion: 1,\n        type: \"chords\",\n        chords: [[chord.actions, chord.phrase]],\n      }),\n    );\n    await navigator.clipboard.writeText(url.toString());\n    let shareComponent: SharePopup;\n    tippy(event.target as HTMLElement, {\n      onCreate(instance) {\n        const target = instance.popper.querySelector(\".tippy-content\")!;\n        shareComponent = new SharePopup({ target });\n      },\n      onHidden(instance) {\n        instance.destroy();\n      },\n      onDestroy(_instance) {\n        shareComponent.$destroy();\n      },\n    }).show();\n  }\n</script>\n\n<th>\n  <ChordActionEdit {chord} />\n</th>\n<td>\n  <ChordPhraseEdit {chord} />\n</td>\n<td class=\"table-buttons\">\n  {#if !chord.deleted}\n    <button transition:slide class=\"icon compact\" on:click={remove}\n      >delete</button\n    >\n  {:else}\n    <button transition:slide class=\"icon compact\" on:click={restore}\n      >restore_from_trash</button\n    >\n  {/if}\n  <button disabled={chord.deleted} class=\"icon compact\" on:click={duplicate}\n    >content_copy</button\n  >\n  <button\n    class=\"icon compact\"\n    class:disabled={chord.isApplied}\n    on:click={restore}>undo</button\n  >\n  <div class=\"separator\" />\n  <button class=\"icon compact\" on:click={share}>share</button>\n</td>\n\n<style lang=\"scss\">\n  .separator {\n    display: inline-flex;\n\n    width: 1px;\n    height: 24px;\n\n    opacity: 0.2;\n    background: currentcolor;\n  }\n\n  button {\n    transition: opacity 75ms ease;\n  }\n\n  td {\n    position: relative;\n  }\n\n  .table-buttons {\n    opacity: 0;\n    transition: opacity 75ms ease;\n  }\n\n  :global(tr):focus-within > .table-buttons,\n  :global(tr):hover > .table-buttons {\n    opacity: 1;\n  }\n</style>\n","<script lang=\"ts\">\n  import { KEYMAP_CODES } from \"$lib/serial/keymap-codes\";\n  import FlexSearch from \"flexsearch\";\n  import LL from \"$i18n/i18n-svelte\";\n  import { action } from \"$lib/title\";\n  import { onDestroy, onMount, setContext, tick } from \"svelte\";\n  import { changes, ChangeType, chords } from \"$lib/undo-redo\";\n  import type { ChordInfo } from \"$lib/undo-redo\";\n  import { derived, writable } from \"svelte/store\";\n  import ChordEdit from \"./ChordEdit.svelte\";\n  import { crossfade, fly } from \"svelte/transition\";\n  import ChordActionEdit from \"./ChordActionEdit.svelte\";\n  import { browser } from \"$app/environment\";\n  import { expoOut } from \"svelte/easing\";\n  import { osLayout } from \"$lib/os-layout\";\n  import randomTips from \"$lib/assets/random-tips/en.json\";\n\n  const resultSize = 38;\n  let results: HTMLElement;\n  const pageSize = writable(0);\n  let resizeObserver: ResizeObserver;\n\n  let abortIndexing: (() => void) | undefined;\n  let progress = 0;\n\n  onMount(() => {\n    resizeObserver = new ResizeObserver(() => {\n      pageSize.set(Math.floor(results.clientHeight / resultSize));\n    });\n    pageSize.set(Math.floor(results.clientHeight / resultSize));\n    resizeObserver.observe(results);\n  });\n\n  onDestroy(() => {\n    resizeObserver?.disconnect();\n  });\n\n  let index = new FlexSearch.Index();\n  let searchIndex = writable<FlexSearch.Index | undefined>(undefined);\n  $: {\n    abortIndexing?.();\n    progress = 0;\n    buildIndex($chords, $osLayout).then(searchIndex.set);\n  }\n\n  function encodeChord(chord: ChordInfo, osLayout: Map<string, string>) {\n    const plainPhrase: string[] = [\"\"];\n    const extraActions: string[] = [];\n    const extraCodes: string[] = [];\n\n    for (const actionCode of chord.phrase ?? []) {\n      const action = KEYMAP_CODES.get(actionCode);\n      if (!action) {\n        extraCodes.push(`0x${actionCode.toString(16)}`);\n        continue;\n      }\n\n      const osCode = action.keyCode && osLayout.get(action.keyCode);\n      const token = osCode?.length === 1 ? osCode : action.display || action.id;\n      if (!token) {\n        extraCodes.push(`0x${action.code.toString(16)}`);\n        continue;\n      }\n\n      if (/^\\s$/.test(token) && plainPhrase.at(-1) !== \"\") {\n        plainPhrase.push(\"\");\n      } else if (token.length === 1) {\n        plainPhrase[plainPhrase.length - 1] =\n          plainPhrase[plainPhrase.length - 1] + token;\n      } else {\n        extraActions.push(token);\n      }\n    }\n\n    if (chord.phrase?.[0] === 298) {\n      plainPhrase.push(\"suffix\");\n    }\n    if (\n      [\"ARROW_LT\", \"ARROW_RT\", \"ARROW_UP\", \"ARROW_DN\"].some((it) =>\n        extraActions.includes(it),\n      )\n    ) {\n      plainPhrase.push(\"cursor warp\");\n    }\n    if (\n      [\"CTRL\", \"ALT\", \"GUI\", \"ENTER\", \"TAB\"].some((it) =>\n        extraActions.includes(it),\n      )\n    ) {\n      plainPhrase.push(\"macro\");\n    }\n    if (chord.actions[0] !== 0) {\n      plainPhrase.push(\"compound\");\n    }\n\n    const input = chord.actions\n      .slice(chord.actions.lastIndexOf(0) + 1)\n      .map((it) => {\n        const info = KEYMAP_CODES.get(it);\n        if (!info) return `0x${it.toString(16)}`;\n        const osCode = info.keyCode && osLayout.get(info.keyCode);\n        const result = osCode?.length === 1 ? osCode : info.id;\n        return result ?? `0x${it.toString(16)}`;\n      });\n\n    return [\n      ...plainPhrase,\n      `+${input.join(\"+\")}`,\n      ...new Set(extraActions),\n      ...new Set(extraCodes),\n    ].join(\" \");\n  }\n\n  async function buildIndex(\n    chords: ChordInfo[],\n    osLayout: Map<string, string>,\n  ): Promise<FlexSearch.Index> {\n    if (chords.length === 0 || !browser) return index;\n    index = new FlexSearch.Index({\n      tokenize: \"full\",\n      encode(phrase: string) {\n        return phrase.split(/\\s+/).flatMap((it) => {\n          if (/^[A-Z_]+$/.test(it)) {\n            return it;\n          }\n          if (it.startsWith(\"+\")) {\n            return it\n              .slice(1)\n              .split(\"+\")\n              .map((it) => `+${it}`);\n          }\n          return it.toLowerCase();\n        });\n      },\n    });\n    let abort = false;\n    abortIndexing = () => {\n      abort = true;\n    };\n    for (let i = 0; i < chords.length; i++) {\n      if (abort) return index;\n\n      const chord = chords[i]!;\n      progress = i;\n\n      if (\"phrase\" in chord) {\n        console.log(encodeChord(chord, osLayout));\n        await index.addAsync(i, encodeChord(chord, osLayout));\n      }\n    }\n    return index;\n  }\n\n  const searchFilter = writable<number[] | undefined>(undefined);\n\n  async function search(index: FlexSearch.Index, event: Event) {\n    const query = (event.target as HTMLInputElement).value;\n    searchFilter.set(\n      query && searchIndex\n        ? ((await index.searchAsync(query)) as number[])\n        : undefined,\n    );\n    page = 0;\n  }\n\n  function insertChord(actions: number[]) {\n    const id = JSON.stringify(actions);\n    if ($chords.some((it) => JSON.stringify(it.actions) === id)) {\n      alert($LL.configure.chords.DUPLICATE());\n      return;\n    }\n    changes.update((changes) => {\n      changes.push({\n        type: ChangeType.Chord,\n        id: actions,\n        actions,\n        phrase: [],\n      });\n      return changes;\n    });\n  }\n\n  function downloadVocabulary() {\n    const vocabulary = new Set(\n      $chords.map((it) =>\n        \"phrase\" in it ? plainPhrase(it.phrase, $osLayout).trim() : \"\",\n      ),\n    );\n    vocabulary.delete(\"\");\n    const blob = new Blob([Array.from(vocabulary).join(\"|\")], {\n      type: \"text/plain\",\n    });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement(\"a\");\n    a.href = url;\n    a.download = \"vocabulary.txt\";\n    a.click();\n    URL.revokeObjectURL(url);\n  }\n\n  const items = derived(\n    [searchFilter, chords],\n    ([filter, chords]) =>\n      filter?.map((it) => [chords[it], it] as const) ??\n      chords.map((it, i) => [it, i] as const),\n  );\n  const lastPage = derived(\n    [items, pageSize],\n    ([items, pageSize]) => Math.ceil((items.length + 1) / pageSize) - 1,\n  );\n\n  setContext(\"cursor-crossfade\", crossfade({}));\n\n  let page = 0;\n</script>\n\n<svelte:head>\n  <title>Chord Manager - CharaChorder Device Manager</title>\n  <meta name=\"description\" content=\"Manage your chords\" />\n</svelte:head>\n\n<div class=\"search-container\">\n  <input\n    type=\"search\"\n    placeholder={$LL.configure.chords.search.PLACEHOLDER(progress + 1)}\n    on:input={(event) => $searchIndex && search($searchIndex, event)}\n    class:loading={progress !== $chords.length - 1}\n  />\n  <div class=\"paginator\">\n    {#if $lastPage !== -1}\n      {page + 1} / {$lastPage + 1}\n    {:else}\n      - / -\n    {/if}\n  </div>\n  <button\n    class=\"icon\"\n    on:click={() => (page = Math.max(page - 1, 0))}\n    use:action={{ shortcut: \"ctrl+left\" }}>navigate_before</button\n  >\n  <button\n    class=\"icon\"\n    on:click={() => (page = Math.min(page + 1, $lastPage))}\n    use:action={{ shortcut: \"ctrl+right\" }}>navigate_next</button\n  >\n</div>\n\n<section bind:this={results}>\n  <!-- fixes some unresponsiveness -->\n  {#await tick() then}\n    <div class=\"results\">\n      <table transition:fly={{ y: 48, easing: expoOut }}>\n        {#if $lastPage !== -1}\n          {#if page === 0}\n            <tr\n              ><th class=\"new-chord\"\n                ><ChordActionEdit\n                  on:submit={({ detail }) => insertChord(detail)}\n                /></th\n              ><td /><td /></tr\n            >\n          {/if}\n          {#each $items.slice(page * $pageSize - (page === 0 ? 0 : 1), (page + 1) * $pageSize - 1) as [chord] (JSON.stringify(chord?.id))}\n            {#if chord}\n              <tr>\n                <ChordEdit {chord} on:duplicate={() => (page = 0)} />\n              </tr>\n            {/if}\n          {/each}\n        {:else}\n          <caption>{$LL.configure.chords.search.NO_RESULTS()}</caption>\n        {/if}\n      </table>\n    </div>\n    <div class=\"sidebar\">\n      <textarea\n        placeholder={$LL.configure.chords.TRY_TYPING() +\n          \"\\n\\nDid you know? \" +\n          randomTips[Math.floor(randomTips.length * Math.random())]}\n      ></textarea>\n      <button on:click={downloadVocabulary}\n        ><span class=\"icon\">download</span>\n        {$LL.configure.chords.VOCABULARY()}</button\n      >\n    </div>\n  {/await}\n</section>\n\n<style lang=\"scss\">\n  .search-container {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .paginator {\n    display: flex;\n    justify-content: flex-end;\n    min-width: 8ch;\n  }\n\n  .new-chord :global(.add) {\n    visibility: hidden;\n  }\n\n  .sidebar {\n    display: flex;\n    flex-direction: column;\n\n    > button {\n      padding-inline-start: 0;\n    }\n  }\n\n  textarea {\n    flex: 1;\n    transition: outline-color 250ms ease;\n    background: none;\n    color: inherit;\n    border: 1px dashed var(--md-sys-color-outline);\n    outline: 2px solid transparent;\n    outline-offset: -1px;\n    margin: 2px;\n    padding: 8px;\n    border-radius: 4px;\n\n    &:focus {\n      outline-color: var(--md-sys-color-primary);\n    }\n  }\n\n  @keyframes pulse {\n    0% {\n      opacity: 0.4;\n    }\n    50% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0.4;\n    }\n  }\n\n  input[type=\"search\"] {\n    width: 512px;\n    margin-block-start: 16px;\n    padding-block: 8px;\n    padding-inline: 16px;\n\n    font-size: 16px;\n    color: inherit;\n\n    background: none;\n    border: 0 solid var(--md-sys-color-surface-variant);\n    border-bottom-width: 1px;\n\n    transition: all 250ms ease;\n\n    @media (prefers-contrast: more) {\n      border-color: var(--md-sys-color-outline);\n      border-style: dashed;\n    }\n\n    &::placeholder {\n      color: var(--md-sys-color-on-surface-variant);\n      opacity: 0.8;\n    }\n\n    &:focus {\n      border-color: var(--md-sys-color-primary);\n      border-style: solid;\n      outline: none;\n    }\n\n    &.loading {\n      opacity: 0.4;\n    }\n  }\n\n  section {\n    position: relative;\n    display: flex;\n\n    overflow: hidden;\n\n    height: 100%;\n    padding-inline: 8px;\n\n    border-radius: 16px;\n  }\n\n  .results {\n    height: 100%;\n    min-width: min(90vw, 16.5cm);\n  }\n\n  table {\n    height: fit-content;\n    overflow: hidden;\n    transition: all 1s ease;\n  }\n</style>\n"],"names":["selectAction","event","select","dismissed","component","ActionSelector","dialog","backdrop","dialogRect","groupRect","scale","dialogScale","dialogTranslate","options","dialogAnimation","backdropAnimation","closed","tick","detail","inputToAction","useKeycodes","KEYMAP_KEYCODES","KEYMAP_IDS","insert_hydration","target","div","anchor","ctx","append_hydration","button_1","toggle_class","sup","dirty","actionstring_changes","chord","$$props","onMount","box","keypress","addSpecial","moveCursor","cursorPosition","deleteAction","action","get","serialPort","insertAction","to","item","$$invalidate","cursorOffset","at","count","changes","ChangeType","clickCursor","button","distance","i","child","offsetLeft","offsetWidth","hasFocus","$$value","focusin_handler","t_value","span","set_data","t","if_block","create_if_block_1","sub","create_if_block_2","create_if_block_3","create_if_block","compare","button1","button0","a","b","dispatch","createEventDispatcher","pressedKeys","editing","makeChordInput","actions","compound","compoundIndices","edit","keydown","input","keyup","chordActions","func","it","button0_disabled_value","th","td0","td1","button2","current","isSameChord","remove","restore","duplicate","id","$chords","share","url","charaFileToUriComponent","shareComponent","tippy","instance","SharePopup","_instance","t0_value","t2_value","t0","t2","t4_value","randomTips","div0","table","div1","textarea","t4","table_transition","create_bidirectional_transition","fly","expoOut","caption","get_key","tr","info","document_1","meta","section","action_destroyer","resultSize","results","pageSize","writable","resizeObserver","abortIndexing","progress","onDestroy","index","FlexSearch","searchIndex","encodeChord","osLayout","plainPhrase","extraActions","extraCodes","actionCode","KEYMAP_CODES","osCode","token","buildIndex","chords","browser","phrase","abort","searchFilter","search","query","page","insertChord","$LL","downloadVocabulary","vocabulary","$osLayout","blob","items","derived","filter","lastPage","setContext","crossfade","input_handler","$searchIndex","$lastPage","duplicate_handler"],"mappings":"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"}