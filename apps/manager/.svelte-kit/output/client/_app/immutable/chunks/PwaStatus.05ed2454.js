import{s as x,e as w,i as m,y as u,d as h,A as y,f as k,g as v,u as b,j as p,x as E}from "./scheduler.f5cfe514.js";import{S as C,i as P}from "./index.c2fc59c9.js";import{_ as N}from "./preload-helper.a4192956.js";import{w as R}from "./index.c76aaf45.js";function L(a={}){const{immediate:e=!1,onNeedRefresh:s,onOfflineReady:n,onRegistered:t,onRegisteredSW:i,onRegisterError:r}=a;let o,c,l;const S=async(g=!0)=>{await c,await l?.()};async function W(){if("serviceWorker"in navigator){const{Workbox:g}=await N(()=>import("./workbox-window.prod.es5.a7b12eab.js"),[],import.meta.url);o=new g("/sw.js",{scope:"/",type:"classic"}),l=async()=>{await o?.messageSkipWaiting()};{let f=!1;const _=()=>{f=!0,o?.addEventListener("controlling", d=>{d.isUpdate&&window.location.reload()}),s?.()};o.addEventListener("installed", d=>{typeof d.isUpdate>"u"?typeof d.isExternal<"u"?d.isExternal?_():!f&&n?.():d.isExternal?window.location.reload():!f&&n?.():d.isUpdate||n?.()}),o.addEventListener("waiting",_),o.addEventListener("externalwaiting",_)}o.register({immediate:e}).then(f=>{i?i("/sw.js",f):t?.(f)}).catch(f=>{r?.(f)})}}return c=W(),S}function O(a={}){const{immediate:e=!0,onNeedRefresh:s,onOfflineReady:n,onRegistered:t,onRegisteredSW:i,onRegisterError:r}=a,o=R(!1),c=R(!1),l=L({immediate:e,onOfflineReady(){c.set(!0),n?.()},onNeedRefresh(){o.set(!0),s?.()},onRegistered:t,onRegisteredSW:i,onRegisterError:r});return{needRefresh:o,offlineReady:c,updateServiceWorker:l}}function U(a){let e,s="offline_pin";return{c(){e=k("div"),e.textContent=s,this.h()},l(n){e=v(n,"DIV",{title:!0,class:!0,"data-svelte-h":!0}),b(e)!=="svelte-u4b4iq"&&(e.textContent=s),this.h()},h(){p(e,"title","App can now be used offline"),p(e,"class","icon")},m(n, t){m(n,e,t)},p:u,d(n){n&&h(e)}}}function j(a){let e,s="update",n,t;return{c(){e=k("button"),e.textContent=s,this.h()},l(i){e=v(i,"BUTTON",{title:!0,class:!0,"data-svelte-h":!0}),b(e)!=="svelte-uwaep3"&&(e.textContent=s),this.h()},h(){p(e,"title","Update ready"),p(e,"class","icon svelte-9dwesr")},m(i, r){m(i,e,r),n||(t=E(e,"click",a[5]),n=!0)},p:u,d(i){i&&h(e),n=!1,t()}}}function A(a){let e;function s(i, r){if(i[0])return j;if(i[1])return U}let n=s(a),t=n&&n(a);return{c(){t&&t.c(),e=w()},l(i){t&&t.l(i),e=w()},m(i, r){t&&t.m(i,r),m(i,e,r)},p(i, [r]){n===(n=s(i))&&t?t.p(i,r):(t&&t.d(1),t=n&&n(i),t&&(t.c(),t.m(e.parentNode,e)))},i:u,o:u,d(i){i&&h(e),t&&t.d(i)}}}function T(a, e, s){let n,t;const{needRefresh:i,updateServiceWorker:r,offlineReady:o}=O();return y(a,i, l=>s(0,n=l)),y(a,o, l=>s(1,t=l)),[n,t,i,r,o,()=>r(!0)]}class B extends C{constructor(e){super(),P(this,e,T,A,x,{})}}export{B as default};
